# Идея: нечто вроде Markdown для научных работ

Меня давно уже посещают мысли о простой, но достаточно гибкой разметке для оформления научных работ.

На первый взгляд, Markdown достаточно для структурирования большей части текста научной работы (кроме титульника, содержания, списка литературы и, возможно, приложений).

Научные работы оформляются по ГОСТу, который требует ссылаться на рисунки, таблицы и тому подобное в предшествующем им абзаце. Этим можно злоупотребить, и вынести такие элементы из Markdown, после чего каким-либо образом вставлять их в результирующий документ (используя макросы LaTeX?). Хочется иметь возможность делать ссылку на документ, возможно, указывая, вставить его прямо здесь — или сразу после абзаца.

В идеале, разметка должна позволять вставлять в документ что угодно, что можно как-то сконвертировать в поддерживаемый формат. Например, если поддерживаются только растровые картинки — конвертировать в них и таблицы, и векторные изображения, и все остальное, что нельзя представить просто в виде текста. Конвертация должна выполняться автоматически (может быть, будет достаточно и правила в Makefile).

Вообще, хотелось бы иметь вариант, позволяющий не думать об оформлении вообще (хотя и оставляя возможность это делать, при необходимости), но сфокусироваться на самом содержании работы. Помечать, что здесь — заголовок, а здесь — рисунок, а об оформлении забыть, либо заниматься им отдельно, редактируя стили определенных блоков (или чего-то вроде них).


## Необходимые элементы
- рисунки
- таблицы


## Проблемы
- оформление конечного документа должно соответствовать ГОСТу
- собственно, способ встройки элементов вроде рисунков и таблиц в работу
- способ создания таблиц должно быть максимально удобным, и в то же время гибким
- автоматическое оформление списков


### Оформление согласно ГОСТу
#### Markdown

Предположительно, для этой цели можно создать шаблон Pandoc, соответствующе его настроив.

Как вариант, можно попробовать сконвертировать Markdown в LaTeX, и использовать готовые шаблоны уже для него.

Недавно, появилась такая вещь как [GOSTdown](https://gitlab.iaaras.ru/iaaras/gostdown/). Однако, она намертво привязана к Word (и, соответственно, к Windows), поскольку использует вордовский COM-интерфейс.


#### LaTeX

Для LaTeX, существует несколько шаблонов для написания научных работ. Из проверенных, у меня заработал лишь этот: https://github.com/AndreyAkinshin/Russian-Phd-LaTeX-Dissertation-Template.


### Cоздание таблиц

Таблицы в Markdown создавать довольно просто, но только если суммарный текст в строке достаточно короткий, чтобы помещаться на экране. Проблема заключается в том, что исходный текст внутри ячейки нельзя разбивать на несколько строк, поскольку перенос строки используется для отделения строк таблицы.

Возможные решения:
- таблицы Pandoc Markdown (как будут вести себя $$-формулы?)
- вынесение длинного текста из таблицы с помощью макросов LaTeX или переменных Pandoc
- использование LaTeX для разметки таких сложных таблиц, со всеми вытекающими последствиями

LaTeX, в свою очередь, позволяет оформлять исходный текст для таблиц каким угодно образом, но синтаксис у него слишком уж громоздкий и, местами, низкоуровневый (например, нужно вставлять в конце каждой строки \hline для добавления линии между строками).

Возможные решения:
- макросы
- пакеты для таблиц


### Автоматическое оформление списков

Элементы списков, по ГОСТу, должны быть оформлены следующим образом:
- текст всех элементов, кроме последнего, заканчивается точкой с запятой
- текст последнего элемента заканчивается точкой

И не очень удобно за этими вещами следить, особенно при добавлении еще одного элемента в конец списка. Было бы удобнее вообще ничего не оставлять в конце строки, и возложить эту задачу на компьютер.

Помимо этого, ГОСТ также требует, чтобы текст элементов начинался со строчной буквы (если это не аббревиатура или нечто подобное, обязательно начинающееся с заглавной). Но это, по крайней мере, легче заметить, и поэтому не столь критично.


## Мысли
### Инструменты/разметки для данной задачи

Следует исследовать:
- Pandoc
- LaTeX
- Asciidoctor
- Pollen


#### Pandoc

Инструмент для конвертации документов из одного формата в другой. Поддерживает большое количество форматов.

Наиболее интересным для нашей задачи является его собественный вариант Markdown.

Имеет возможность создавать свои [фильтры](https://pandoc.org/filters.html) на [Haskell](https://pandoc.org/filters.html#a-simple-example), а также [Python, Lua и еще ряде языков](https://pandoc.org/filters.html#but-i-dont-want-to-learn-haskell). Фильтры преобразуют AST, полученный путем разбора исходного файла Pandoc'ом.

Это является и плюсом, и минусом фильтров. Плюс заключается в том, что не приходится работать с сырым текстом. Минус же — в том, что фильтры не позволяют (по крайней мере, легко) добавлять новый синтаксис, поскольку предназначены для преобразования существующих элементов документа.


#### LaTeX

Определенно позволяет оформить работу по ГОСТу, но, при этом, сам по себе сравнительно сложен для изучения.

Расширения можно создавать на самом LaTeX. Не совсем понятно, существует ли какой-то уровень абстракции над текстом (списки строк, например).